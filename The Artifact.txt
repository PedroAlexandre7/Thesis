Chapter 3: The Artifact: A Declarative IoT Dimensioning Model

3.1 Overview and Design Philosophy

This chapter details the design and implementation of the thesis artifact: a Declarative Excel-based IoT Dimensioning Framework.

As outlined in Chapter 1, the primary objective of this work is to bridge the gap between rigid, "black-box" professional simulators and fragile, ad-hoc spreadsheets. While standard spreadsheets are accessible, they often suffer from scalability issues; adding a new variable (e.g., a new planning year or a new vertical) typically requires manual restructuring of the entire workbook, leading to errors and auditing difficulties (Caulkins et al., 2007).

To address Research Question 4 (How can the complex process of public IoT network dimensioning be simplified...?), the proposed artifact adopts a Meta-Programming approach. The core design philosophy is the strict separation of the definition of the model from its instantiation.

Instead of hard-coding logic into specific cells, the user defines the structure of the desired analysis—such as the planning horizon, geographical segmentation, and service taxonomy—in a centralized configuration interface. An automation engine (implemented in VBA) then interprets these high-level instructions to dynamically construct the necessary analysis sheets. This architecture transforms the workbook from a static calculation file into a dynamic modeling environment, ensuring that the tool remains:

Scalable: Capable of handling varying numbers of regions or verticals without structural redesign.

Transparent: Ensuring that all dimensioning assumptions are explicit and auditable.

Assumption-Driven: Facilitating rapid "first-pass" dimensioning by allowing planners to toggle key constraints (e.g., traffic concurrency, coverage thresholds) centrally.

3.2 System Architecture

The artifact functions as a layered application built within the Microsoft Excel environment. It is architected around three distinct layers, as illustrated in the system design:

3.2.1 The Configuration Layer (The "Blueprints")
The entry point for the planner is the Model Configurator sheet. This sheet acts as a domain-specific language (DSL) where the user defines the "Instructions" for the model. As seen in the tool's interface, this layer accepts the following abstract commands:

Output: Designates the target sheets for generating calculation tables. It acts as the container definition, instructing the engine where to place the data blocks.

Title: Groups data by logical entities (e.g., "Regions"). This instruction triggers the iterative generation of tables, ensuring that a separate analysis block is created for every defined entity (e.g., creating a table for "Central Coast", "Cessnock", etc.).

Years: Defines the temporal scope (e.g., 2023, 2025, 2030). This instruction controls the time-dimension expansion, automatically replicating columns or sheets to accommodate the defined planning horizon.

Header: Defines the static horizontal structure of a table. It maps to specific row inputs (e.g., "Throughput", "Devices", "Cost") that form the column headers of the generated analysis tables.

Column: Defines the vertical structure or data drivers. This instruction pulls lists from input sheets (e.g., the list of 15 "Verticals" or 10 "Base Station Types") to dynamically determine the height of the generated tables, ensuring the model adapts automatically if items are added to or removed from the source lists.

3.2.2 The Automation Layer (The "Engine")
The logic core is a VBA-based automation backend that reads the Configuration Layer and algorithmically builds the spreadsheet. This layer is encapsulated in the CreateTablesFromInput macro and relies on several custom classes and modules:

InputCells Class: An object representing a block of user inputs (e.g., a table of device densities). It stores metadata such as rowShift and columnShift, allowing the engine to place data dynamically without hard-coded cell references.

TableSetData Class: Manages the properties of the output sheets, determining if data should be cleared, preserved, or if new sheets need to be generated for each study year.

Main Module: The execution loop that iterates through the configuration instructions. It detects the instruction type (e.g., Header, Column, Output) and calls the CreateTables subroutine to render the content.

3.2.3 The Data Layer (The "Interface")
The final layer consists of the generated Input and Output sheets where the actual planning occurs. These sheets are categorized into:

Network Supply: Base Stations Sites, Base Stations Profiles.

Service Demand: Study Years, Regions, Verticals_Sectors.

Dimensioning Logic: Throughput Formulas, Output Formulas.

3.3 Functional Components and Input Structure

The artifact organizes the dimensioning process into logical steps that align with the Traffic Theory principles discussed in Section 2.2.

3.3.1 Service Taxonomy (Verticals_Sectors)

Reflecting the "Verticals" approach advocated by the Municipal IoT Blueprint (Barkis et al., 2019), the model begins by defining the service taxonomy. The Verticals_Sectors sheet acts as the primary dimension for traffic generation. By categorizing services (e.g., "Utilities," "Public Safety"), the tool allows for granular traffic profiling, ensuring that low-bandwidth sensors are differentiated from high-bandwidth video streams.

3.3.2 Network Parameters and Traffic Engineering

The Network Parameters sheet serves as the repository for the global assumptions driving the capacity dimensioning. It translates the theoretical concepts of Erlang and Packet Switching into concrete inputs:

Busy Hour Contention Ratio: Defines the concentration of traffic during peak windows.

Headroom: Implements the "resiliency buffer" described in the State of the Art, allowing planners to set a safety margin (e.g., 20%) for emergency spikes.

3.3.3 Infrastructure Definition (Base Stations Sites & Profiles)

To support the technology-agnostic requirement (RQ1), the artifact separates the physical site counts from their technological capabilities.

Base Stations Sites: Captures the "Supply" side of the equation—how many physical locations are available or planned per region.

Base Stations Profiles: Defines the capability of each site type (e.g., "Standalone 5G - 3 Sectors" vs. "LoRaWAN Gateway"). This sheet includes critical dimensioning thresholds such as "Maximum Simultaneously Active Users" and "Maximum Throughput for Downlink," allowing the model to flag saturation based on either user density or data volume.

3.4 The Calculation Engine

The logical core of the artifact resides in the Throughput Formulas and Base Stations Parameters sheets. Here, the tool synthesizes the inputs to perform the actual dimensioning.

3.4.1 Throughput and Capacity Dimensioning

The model calculates the Aggregate Demand for every combination of Year, Region, and Vertical. It utilizes the formulas discussed in Section 2.3, multiplying the number of devices by their specific traffic profiles (throughput buckets) and applying the Busy Hour factor.

Simultaneously, it calculates Network Supply based on the site profiles. A key feature of the artifact, visualized in the Output Formulas sheet, is the automated comparison of Demand vs. Supply. The model calculates saturation percentages, highlighting functionality gaps where demand exceeds the "Capacity Limited" constraints of the network.

3.4.2 Coverage and Path Loss Validation

While the primary focus is capacity, the artifact includes a coverage validation module in Base Stations Parameters. As detailed in the State of the Art, rigorous ray-tracing is often infeasible for high-level planning. Therefore, this tool implements formula-based Path Loss calculations (aligned with 3GPP TR 38.901 concepts) directly within the spreadsheet cells.

By defining parameters such as Transmit Power, Antenna Gains, and Frequency (e.g., 800 MHz vs. 26 GHz), the model estimates the maximum cell radius. This allows the user to sanity-check if the number of sites proposed in the "Capacity" step is sufficient to provide physical signal coverage across the target region's area.

3.5 Conclusion

The artifact presented is not merely a calculator but a Declarative Modeling Environment. By leveraging VBA to automate the structural management of the spreadsheet (CreateTablesFromInput), it resolves the tension between the flexibility required for strategic planning and the robustness required for engineering. It successfully operationalizes the theoretical constraints of Smart City IoT—from vertical taxonomies to link budgets—into a usable, auditable, and scalable tool.